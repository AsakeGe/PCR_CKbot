# PCR_CKbot

QQ自动收集核酸采样证明并汇总机器人，目前已经基本可用，但仅限收集与打包发送。

## 使用

### 关于go-cqhttp部分：
  * 需要搭配 [go-cqhttp](https://github.com/Mrs4s/go-cqhttp) 使用。
  * 在配置 go-cqhttp 时，请选择 "HTTP API"
  * 在config.yml中，开启POST
  * 在config.yml中，将 "- url: http://0.0.0.0:5701/ # 地址" 中 “0.0.0.0” 更改为本项目运行设备的IP地址
  * 请牢记在config.yml中设置的正、反向端口，地址
### 关于本项目的部分：
### 帮助
  * 私聊向机器人发送 #帮助 即可获取使用说明 

### 其他
  * 目前仅针对西安邮电大学每日核酸统计设计，其他要使用的话，建议魔改。

### 使用说明
  * 在群建立好后，拉go-cqhttp绑定的QQ小号进群，邀请需要上交结果的人入群。
  * 注意：目前是一次性的，如果需要后期让更多人入群需要重新录入数据（待解决）
  * 所有的输入均在群聊天框内输入
  * 请在启动本项目前，手动配置config文件夹内项目 
  * 指令：
 群聊指令：
  * 管理员指令：
    * 1：#创建班级：XXXX
    * 2：#导入群成员【第一次，创建表，包括群成员QID，学号，班级，姓名，检查点】
    * 3：#未上传【本群内今日未上传核酸采样数据人员名单以人数】
    * 4：#at未上传【@本群内今日未上传核酸采样数据人员，提醒上传】
    * 5：#导出：YYYY-MM-DD【打包导出本群内指定日期截图，以私聊形式发送给请求导出管理员】
    * 6:#排除管理员 【管理员不参与信息收集】{暂未启用}
    * 7:#开启收集 【此时开始下载群内发来的所有图片】{暂未启用}
    * 8:#关闭收集 【此时停止下载群内发来的所有图片】{暂未启用}
    * 9：【待定】
  * 所有成员指令：
    * 1：#学号：xxxx
    * 2：#班级：xxxx
    * 3：#姓名：xxxx
    * 4：【待定】
  * 私聊指令：
    * 1：#帮助
    * 2：【待定】
    
## 未来计划
  * 完成目前尚未启用功能部分
  * 加入存储空间定期删除及手动删除功能
  * 待定
## 更新记录
  * 2022-11-29
    * Version 2.0 版本完成
    * 极大的强化了鲁棒性
    * 改用Redis键值数据库，解决了因数据库I/O性能不足导致的丢数据问题
    * 重构了指令识别逻辑
    * 目前仍然不可用于生产力环境
  * 2022-11-24
    * 基本的收集，统计，打包功能已经就绪。由于时间问题，目前只能规规矩矩的按顺序使用命令，重复键入命令可能会导致某些奇奇怪怪的问题，甚至于直接不可用。
  * 2022-11-23：
    * 修改了数据库使用模式，支持多个群使用。
    * 能够使用统计功能了，但自动执行与 @ta 应该会在未来的某一天实现。